from scipy.spatial.distance import cdist

def read_vectors(vector_file):
	song_ids = []
	song_vecs= []
	with open(vector_file, 'r') as vector_doc:
		for line in vector_doc.readlines():
			song_id, vector = line.split(';')
			song_ids.append(song_id)
			song_vecs.append(vector[:-1].split(','))
	return song_ids, song_vecs

def read_info(info_file):
	song_info = {}
	with open(info_file, 'r') as info_doc:
		for line in info_doc.readlines():
			song_id, start, end, artist, song_name = line.split(';')
			song_info[song_id] = artist + " - " + song_name[:-1]
	return song_info


def compare_vectors(new_vector, vector_file, info_file):
	ids, vecs = read_vectors(vector_file)
	song_info = read_info(info_file)
	scores = cdist([new_vector], vecs, 'cosine')
	# scores = cdist([new_vector], vecs, 'seuclidean')
	ranking = [x for _, x in sorted(zip(scores.tolist()[0], ids), reverse=False)]
	sorted_scores = sorted(scores.tolist()[0], reverse=False)[:10]
	for rank, score in zip(ranking[:10], sorted_scores):
		print(song_info[rank], score)
	return ranking


# read_vectors()
# #feet don't fail me now
# test1_vector = [-0.31401947140693665, 0.1405218094587326, -0.031601209193468094, 0.7063797116279602, 0.2709586024284363, -0.33247891068458557, -0.24432061612606049, -0.3320232033729553, -0.24691390991210938, 0.5498238801956177, 0.03665859252214432, 0.33021488785743713, -0.5948417782783508, 0.06541872024536133, -0.5839627385139465, 0.8164838552474976, 0.8061424493789673, 0.40404728055000305, -0.23159366846084595, -0.4069431722164154, -0.24735496938228607, 0.5200427174568176, -0.5203890204429626, -0.41704481840133667, 0.2765117883682251, -0.2331569790840149, 0.3903746008872986, -0.2625441551208496, 0.019579116255044937, 0.4426925480365753, -0.11623158305883408, 0.16149169206619263, 0.4736440181732178, -0.9951035976409912, -0.03421083465218544, -0.35216909646987915, 0.3026374578475952, -0.14572913944721222, 0.42851656675338745, -0.6020353436470032, 0.10386917740106583, 0.036581315100193024, 0.3197100758552551, -0.01018316950649023, 0.5276339650154114, 0.13180239498615265, -0.44402027130126953, -0.29409313201904297, 0.13636116683483124, -0.267928808927536, -1.3611234426498413, 0.43290841579437256, -0.36097291111946106, 0.04706266522407532, -0.4382511377334595, -0.27382150292396545, -0.17418920993804932, -0.3770505487918854, -0.41725459694862366, -0.10023228079080582, 0.618857204914093, -0.15481768548488617, -0.26058635115623474, 0.12405116111040115, 0.23410670459270477, 0.24784761667251587, 0.11850143224000931, 0.09587176889181137, -0.1761823147535324, 0.4849962890148163, 0.06917689740657806, 0.2303849309682846, 0.5252043604850769, 0.6726310849189758, -0.16349534690380096, 0.09818245470523834, -0.06528290361166, 0.20063906908035278, -0.7625922560691833, -0.21907749772071838, -0.31419479846954346, 0.37244775891304016, 0.18959940969944, -0.6432307362556458, -0.472628116607666, 0.3107118010520935, 0.10848791152238846, 0.28971245884895325, -0.48728564381599426, -0.023973850533366203, 0.43418654799461365, -0.21001720428466797, -0.6632682681083679, 0.21123699843883514, -0.42194390296936035, -0.3308834135532379, -0.08858413249254227, 0.3464601933956146, 0.008333834819495678, 0.25421831011772156]
# #rape me
# test2_vector = [-0.11078214645385742, -0.3325881063938141, 0.7493009567260742, 0.4799930155277252, 0.07358277589082718, 0.0037848977372050285, -0.12935978174209595, -0.06379351019859314, 0.018734952434897423, 0.7067536115646362, 0.7001391649246216, 0.5686023235321045, -0.32944223284721375, 0.09409907460212708, -0.6302806735038757, 0.6449463367462158, 1.0051765441894531, 0.5595347881317139, -0.5589401125907898, -0.5316323041915894, -0.9298161268234253, 0.6946070790290833, -0.3102887272834778, -0.7652646899223328, 0.020477820187807083, 0.05901603400707245, 0.6089680194854736, -0.10657031834125519, 0.00906187854707241, 0.8246071934700012, -0.1735377162694931, 0.35064148902893066, 0.7335562705993652, -0.5722955465316772, -0.04839908704161644, -0.5729540586471558, 0.0759822204709053, -0.12043053656816483, 0.33081895112991333, -0.31965208053588867, 0.6154586672782898, 0.052916478365659714, 0.44692718982696533, -0.2607136368751526, 0.30706915259361267, 0.019364604726433754, -0.16197054088115692, 0.2769390046596527, -0.11662080883979797, -0.4236795902252197, -1.6168843507766724, 0.6785329580307007, -0.2820291519165039, 0.24629995226860046, -0.7481623888015747, -0.010852586477994919, -0.1763385385274887, -0.5324757099151611, -0.3235830068588257, -0.6823962330818176, 0.4903870224952698, 0.045676372945308685, -0.3978399336338043, 0.32817429304122925, 0.33981484174728394, 0.32496824860572815, 0.001072089304216206, 0.5095492005348206, -0.4155214726924896, 0.56591796875, 0.051511604338884354, 0.23183275759220123, 0.6009246706962585, 0.9668593406677246, -0.2596804201602936, -0.18851186335086823, -0.042251236736774445, 0.10350245982408524, -1.0204825401306152, -0.11252801865339279, 0.01078636571764946, 0.045220620930194855, 0.5038908123970032, -1.39063560962677, -0.6145012378692627, 0.3215366005897522, 0.23187080025672913, 0.21112902462482452, -1.3347396850585938, 0.1949206292629242, 0.54632169008255, -0.4720361530780792, -0.8138242959976196, 0.18099790811538696, -0.43206870555877686, -0.4159221649169922, 0.10418810695409775, 0.6923022866249084, 0.6283926367759705, -0.32412850856781006]
# #lithium
# test3_vector = [0.07321079075336456, 0.21189744770526886, 0.4238341152667999, 0.4093325436115265, 0.43431636691093445, -0.4472208023071289, -0.1366564780473709, -0.29329589009284973, -0.38264286518096924, 0.7552350759506226, 0.05477394536137581, 0.1133761927485466, -1.110486626625061, 0.1202760636806488, -0.4322081208229065, 0.5255283117294312, 0.8360174298286438, 0.32983458042144775, -0.7457388043403625, -0.2812897861003876, -0.47295427322387695, 0.8138974905014038, -0.36443808674812317, -0.4411150813102722, 0.30855828523635864, -0.21013154089450836, 0.5086673498153687, -0.4406936466693878, -0.030905932188034058, 0.32712477445602417, -0.16534514725208282, 0.07408979535102844, 0.5675563216209412, -1.3018766641616821, -0.1687248796224594, -0.8451462984085083, 0.36572009325027466, -0.0911690816283226, -0.22018209099769592, -0.9760259985923767, 0.3032718300819397, 0.008627246133983135, 0.4946408271789551, -0.1973162293434143, 0.5514750480651855, 0.3665519952774048, -0.2647746503353119, -0.4191613495349884, 0.3333894610404968, 0.10130521655082703, -1.4712905883789062, 0.47618168592453003, -0.6264619827270508, -0.18784117698669434, -0.45069536566734314, -0.41443026065826416, -0.24196965992450714, -0.28160396218299866, 0.18900831043720245, -0.5093972682952881, 0.8638325333595276, 0.3450659513473511, -0.3570384681224823, 0.29877692461013794, 0.6540245413780212, 0.47006696462631226, -0.16243554651737213, 0.1531985104084015, -0.37333840131759644, 0.44967302680015564, 0.11491364240646362, 0.5751758217811584, 0.33019107580184937, 0.5886220932006836, -0.4814293384552002, 0.02770964987576008, -0.08877700567245483, 0.14387479424476624, -0.7500373721122742, 0.09409846365451813, -0.14949515461921692, 0.3462810218334198, 0.4016560912132263, -1.5038790702819824, -0.713062047958374, 0.012813648208975792, 0.055807795375585556, 0.26031529903411865, -0.7948490381240845, -0.4925391674041748, 0.18336141109466553, -0.501531720161438, -0.4409977197647095, 0.12415822595357895, -0.40520355105400085, -0.37533295154571533, -0.21945729851722717, 0.46734344959259033, 0.11868436634540558, 0.05395969748497009]
# #i want you (beatles)
# test4_vector = [-0.34848207235336304, 0.11569679528474808, 0.18744570016860962, 0.6317757368087769, 0.5679589509963989, -0.16511227190494537, -0.38363030552864075, -0.1964137703180313, -0.7371541857719421, 0.42813840508461, -0.1717458963394165, -0.12091755867004395, -0.6045002937316895, -0.04905920475721359, -0.9665562510490417, 0.6555701494216919, 1.250145673751831, 0.5384039878845215, -0.7491704225540161, -0.23652192950248718, -0.519347608089447, 0.937191367149353, -0.2553325295448303, -0.49186214804649353, 0.3950032591819763, -0.6385518908500671, 1.7375773191452026, -0.428751677274704, 0.6514516472816467, 0.5494289994239807, -0.3108031153678894, 0.23183172941207886, 0.6269283890724182, -0.8435103297233582, -0.22932854294776917, -0.6585472822189331, 0.4820825457572937, -0.3039183020591736, 0.25466349720954895, -1.4935556650161743, 0.8230876922607422, 0.4044795632362366, 0.5634902715682983, -0.06540847569704056, 0.6147927045822144, -0.14088627696037292, -0.27332356572151184, -0.4327890872955322, 0.29363617300987244, 0.6551239490509033, -2.0648958683013916, 0.6900076866149902, -0.760344386100769, 0.12364959716796875, -0.44364237785339355, -0.6938337683677673, -0.2634510397911072, -0.8728221654891968, -0.26079583168029785, -0.3572821021080017, 1.0998265743255615, 0.3063885569572449, -1.2012256383895874, 0.5432072877883911, 0.9071562886238098, 0.77894127368927, -0.1036226898431778, 0.17459778487682343, 0.02270434983074665, 0.39397406578063965, 0.30787134170532227, 0.570423424243927, 0.9225212335586548, 0.9935516119003296, -0.3770793676376343, 0.39408692717552185, 0.16591498255729675, 0.5175557136535645, -1.2642362117767334, 0.1554599404335022, -0.38848382234573364, 0.3899240493774414, 0.20262297987937927, -1.81009840965271, -0.46564334630966187, 0.5378222465515137, 0.35797104239463806, 0.6661878824234009, -0.3096716105937958, -0.5112522840499878, 0.41126683354377747, -0.38950401544570923, -1.0403409004211426, 0.6376754641532898, -0.06159510463476181, -0.16146326065063477, -0.7792670726776123, 0.34214475750923157, -0.2225935161113739, 0.6611262559890747]
# ranking = compare_vectors(test3_vector, "songs.vectors", "songlyrics/songdata.index.txt")

# # print(ranking)